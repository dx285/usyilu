!function(e){var a=function(){return!0},t=0;e.uploadDefault={url:"",fileName:"filedata",dataType:"json",fileType:"*",params:{},onSend:a,onSubmit:a,onComplate:a},e.upload=function(a){var n=e.extend(jQuery.uploadDefault,a);if(""!=n.url){var o=n.onSend();if(o){var i="upload_frame_"+t++,r=e('<iframe style="position:absolute;top:-9999px" />').attr("name",i),l=e('<form method="post" style="display:none;" enctype="multipart/form-data" />').attr("name","form_"+i);l.attr("target",i).attr("action",n.url);var p='<input type="file" name="'+n.fileName+'" onchange="onChooseFile(this,\''+n.fileType+"')\">";for(key in n.params)p+='<input type="hidden" name="'+key+'" value="'+n.params[key]+'">';l.append(p),r.appendTo("body"),l.appendTo("body"),l.submit(n.onSubmit),r.load(function(){var a=e(this).contents().get(0),t=e(a).find("body").text();"json"==n.dataType,n.onComplate(t),setTimeout(function(){r.remove(),l.remove()},5e3)});var u=e("input[type=file][name="+n.fileName+"]",l);u.click()}}}}(jQuery);var onChooseFile=function(e,a){var t=checkFileType(e,a);if(t){var n=$(e).parent();n.submit()}},checkFileType=function(e,a){var t=e.value.substring(e.value.lastIndexOf(".")+1);if(""!=t&&"*"!=a){var n=a.split(",");if($.inArray(t,n)==-1)return ST.Util.showMsg("文件类型不正确,请上传"+a+"格式的文件",5,1e3),e.value="",!1}return!0};